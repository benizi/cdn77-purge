
# cdn77purge

Make sure CDN77 has the lastest files.

This program should be run after an update of my web site content in Wordpress at my origin.

I have a slightly different setup than most, since my complete site is hosted on the CDN.

Advantage, you get a lot of speed.

Disadvantage, more work, for example the site map generated by my origin (wordpress) points to the origin, and not to the CDN. Also, all pages generated by WP needs to be static, which is not a problem for me, since I do not have a shopping basket, and rely on Google analytics.

## Design

 * First download sitemap.xml from the origin.
 * Loop over all urls in the sitemap and download each webpage from both origin and cdn
   * compare the webpage - ignoring some irrelevant differences - and remember all that differ
 * Divide the ones that differ into batches, currently 20 (batch-size)
   * POST each batch to https://client.cdn77.com/support/api/version/2.0/data#Prefetch

## Installation

Clone, compile using "lein compile" and "lein repl" and run (force-refresh).

You will need to create a cdn77.config files that looks like this and place it in the same directory as the jar file or any of it's parents directories.

```
{:login "email"
 :passwd "cdn77key"
 :cdn_id "6534784"
 :origin "http://www2.spreadsheetconverter.com"
 :cdn "http://www.spreadsheetconverter.com"
 }	
```

## Usage

FIXME: explanation

    $ java -jar cdn77purge-0.1.0-standalone.jar [args]

## Options

FIXME: listing of options this app accepts.

## Examples

...

### Improvements

There are other issues I hope CDN77 will fix
 * forward the etag
 * forward the last-modified
so I do not have to compare page by contents, and just can do all this by using HEAD instead of GET.

### Bugs

...


### Any Other Sections
### That You Think
### Might be Useful

## License

Copyright Â© 2015 Mattias W

Distributed under the Eclipse Public License either version 1.0 or (at
your option) any later version.
